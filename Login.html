<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<style>
    .hidden{
        display: none;
    }
    .main_hidden{
        display: block;
    }
    .icon {
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 10px;
    }

</style>
</head>
<body>

    <div id="main-page" class="main_hidden">
        <h1>Health and Fitness tracking app</h1>
        <div class="icon" onclick="showRegister()">Register</div>
    </div>

    <div id="login-page" class="hidden">
        <h1>Login</h1>
        <form onsubmit="login(event)">
            <label for="username">Email:</label>
            <input type="text" id="username" required><br><br>
            <label for="password">Password:</label>
            <input type="password" id="password" required><br><br>
            <button type="submit">Login</button>
            <button type="button" onclick="showRegister()">Register</button>
            <button onclick="logout()">Log out</button>
        </form>
    </div>

    <div id="register-page" class="hidden">
        <h1>Register</h1>
        <form onsubmit="register(event)">
            <label for="new-username">Email:</label>
            <input type="text" id="new-username" required><br><br>
            <label for="new-password">Password:</label>
            <input type="password" id="new-password" required><br><br>
            <button type="submit">Register</button>
            <button type="button" onclick="showLogin()">Back to login page</button>
            <button onclick="logout()">Log out</button>
        </form>
    </div>

<script>
    // finished

        let users = JSON.parse(localStorage.getItem('users')) || {};
        let currentUser = null;

        const loginPage = document.getElementById('login-page');
        const registerPage = document.getElementById('register-page');
        const mainPage = document.getElementById('main-page');

        function show_RegisterLogin(){
            showRegister()
        }

        function showLogin() {
            loginPage.style.display = 'block';
            registerPage.style.display = 'none';
            mainPage.style.display = 'none';
        }

        function showRegister() {
            loginPage.style.display = 'none';
            registerPage.style.display = 'block';
            mainPage.style.display = 'none';
        }

        function showMainPage() {
            loginPage.style.display = 'none';
            registerPage.style.display = 'none';
            mainPage.style.display = 'block';
        }

        function login(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (users[username] && users[username].password === password) {
                currentUser = username;
                showMainPage();
            } else {
                alert('Email or Password is incorrect!');
            }
        }

        function register(event) {
            event.preventDefault();
            const username = document.getElementById('new-username').value;
            const password = document.getElementById('new-password').value;

            if (users[username]) {
                alert('Accout is existed!');
            } else {
                users[username] = {
                    password: password,
                    }
                };
                localStorage.setItem('users', JSON.stringify(users));
                alert('Successful registerÔºÅ');
                showLogin();
            }

            function logout() {
            currentUser = null;
            showMainPage();
        }
    
            window.onload = showMainPage;
    
</script>
</body>
</html>