<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    .hidden{display: none;}
    .main-page-hidden{display: block;}
</style>
<body>
    <div class="hidden" id="missionList">
        MissionList :
        <div>Mission 1: xp: 20<button class="btn">Complete</button></div>
        <div>Mission 2: xp: 20<button class="btn">Complete</button></div>
        <div>Mission 3: xp: 30<button class="btn">Complete</button></div>
    </div>
    
    <button id="showMissionList">Mission list<button id="leave">X</button></button>

    <div class="main-page-hidden" id="main-page">
        <h2>Main page</h2>
        <p>Level: <span id="level-display">0</span></p>
        <p>XP: <span id="xp-display">0</span></p>
        <p>Next level XP: <span id="nextLevelXP-display">100</span></p>
        <div class="progress-bar"></div>
    </div>

    <button id="clearData">Clear Data</button>

    <script>
        const clearData = document.getElementById('clearData');

clearData.addEventListener('click', function() {
    localStorage.clear();
    xp = 0;
    level = 0;
    nextLevelXP = 100;
    xpDisplay.innerHTML = `${xp}`;
    levelDisplay.innerHTML = `${level}`;
    nextLevelXP_Display.innerHTML = `${nextLevelXP}`;
    alert('All data has been cleared.');
});


        let level = parseInt(localStorage.getItem('level')) || 0
        let xp = parseInt(localStorage.getItem('xp')) || 0
        let nextLevelXP = parseInt(localStorage.getItem('nextLevelXP')) || 100
        
        const showMissionList = document.getElementById('showMissionList')
        const missionList = document.getElementById('missionList')
        const btn = document.getElementsByClassName('btn')
        const leave = document.getElementById('leave')
        const mainPage = document.getElementById('main-page')
        let xpDisplay = document.getElementById('xp-display')
        let levelDisplay = document.getElementById('level-display')
        let nextLevelXP_Display = document.getElementById('nextLevelXP-display')

        showMissionList.addEventListener('click', function(){
            missionList.classList.remove('hidden')
            mainPage.style.display = 'none'
       })

       leave.addEventListener('click', function(){
        missionList.classList.add('hidden')
        mainPage.style.display = 'block'
       })

       for(let i = 0; i < btn.length; i++){
            btn[i].addEventListener('click', function(){
                btn[i].innerHTML = 'Completed'
                btn[i].disabled = true
                if(i === 0){
                    xp += 20
                }else if(i === 1){
                    xp += 20
                }else if(i === 2){
                    xp += 30
            }
            localStorage.setItem('xp', xp)
            localStorage.setItem(`mission${i}Date`, new Date().toDateString())
            xpDisplay.innerHTML = `${xp}`
            checkLevelUP()
        })}

        function checkLevelUP(){
            if(xp >= nextLevelXP){
                level ++
                xp = xp - nextLevelXP
                nextLevelXP = Math.round(nextLevelXP * 1.5)
                alert(`Level up! You are now level ${level}.`)
                localStorage.setItem('xp', xp)
                localStorage.setItem('level', level)
                localStorage.setItem('nextLevelXP', nextLevelXP)
                xpDisplay.innerHTML = `${xp}`
                levelDisplay.innerHTML = `${level}`
                nextLevelXP_Display.innerHTML = `${nextLevelXP}`
        }}
       
        function updateMission(){
            let currentDate = new Date().toDateString()
            let lastDate = localStorage.getItem('lastDate')
            localStorage.setItem('lastDate', lastDate)
            for(let i = 0; i < btn.length; i++){
                let missionDate = localStorage.getItem(`mission${i}Date`)
                if(missionDate !== currentDate){
                    btn[i].disabled = false
                    btn[i].innerHTML = 'Complete'
                }
            }
            }

        function loadValues() {
            xpDisplay.innerHTML = `${xp}`;
            levelDisplay.innerHTML = `${level}`;
            nextLevelXP_Display.innerHTML = `${nextLevelXP}`;
        }

        window.onload = function() {
             loadValues();
             updateMission();
             checkLevelUP();
        }
    </script>
</body>
</html>
